<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://ossirytk.github.io/llama-cpp-chat-memory/running_the_chatbot/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Running the chatbot - Llama.cpp chat</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Running the chatbot";
        var mkdocs_page_input_path = "running_the_chatbot.md";
        var mkdocs_page_url = "/llama-cpp-chat-memory/running_the_chatbot/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Llama.cpp chat
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Quickstart</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../getting_started/">Getting started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../prompt_support/">Prompt Support</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../card_format/">Card Format</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../configs/">Configs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../preparing_the_env/">Preparing the env</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">The chatbot</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../running_the_env/">Running the env</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Running the chatbot</a>
    <ul class="current">
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Working with documents</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../webscraping/">Webscraping</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../csv/">Csv filtering and parsing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../named_entity_recognition/">Named Entity Recognition(NER)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../creating_embeddings/">Creating embeddings</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Extras</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../examples/">Some Examples</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../UNLICENSE/">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Llama.cpp chat</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">The chatbot</li>
      <li class="breadcrumb-item active">Running the chatbot</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ossirytk/llama-cpp-chat-memory/edit/master/docs/running_the_chatbot.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h3 id="running-the-chatbot">Running the chatbot</h3>
<p>To run the chatbot. You need to run the chat with the custom script instead of the chainlit run command.
The reason for this is the updates for the config files when switching character. 
These changes need to be done before calling chainlit.</p>
<p>If you call chainlit directly, the character name and avatar picture won't update.</p>
<p>Note: Currently something seems to be cached by chainlit. Until I find a way to clear the cache,
you need to call run_chat twice for changes to take effect.</p>
<p>Some browsers don't allow loading css file from local directories. For testing purposes there is a flask script to run a simple http server that serves stylesheets from the "static/" directory. You will need to run the flask server in another terminal instance.</p>
<pre><code>cd src\llama_cpp_langchain_chat
python -m run_chat
</code></pre>
<p>The chatbot should open in your browser<BR></p>
<p>Running flask</p>
<pre><code>hatch shell chat
cd .\src\llama_cpp_chat_memory\
flask --app flask_web_server run
</code></pre>
<h3 id="avatar-images">Avatar Images</h3>
<p>Avatar images need to be stored in the .\public\avatars folder. Make sure that the folder exists. Character cards in png format will have a copy of the image data saved in the avatars folder automatically. If you copy an image manually, make sure that the filename matches the name is the character card and replace the whitespace in the name with underscores.</p>
<h3 id="vector-search">Vector search</h3>
<p>The search for relevant documents from chroma happens based on VECTOR_SORT_TYPE and VECTOR_K. The search will return VECTOR_K+4 closest matches and sorts by sort type before appending to vector_k. Default search simply sorts by distance. "bm25" sorts with the bm25 search algorithm. Fusion rank gets the combined results of both.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../running_the_env/" class="btn btn-neutral float-left" title="Running the env"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../webscraping/" class="btn btn-neutral float-right" title="Webscraping">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ossirytk/llama-cpp-chat-memory" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../running_the_env/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../webscraping/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
